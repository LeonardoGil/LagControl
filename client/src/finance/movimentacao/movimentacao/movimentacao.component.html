<main class="flex flex-col gap-5">
    
    <mat-card appearance="outlined" class="flex flex-col gap-2">
        <mat-card-header>
            <mat-card-title class="text-2xl">
                Movimentações
            </mat-card-title>
        </mat-card-header>
        
        <mat-card-content>
            <div class="grid grid-cols-3 grid-rows-2 gap-6 p-3 overflow-x-auto">

                <div class="form-input mt-3" style="flex-grow: 2;">
                    <mat-form-field class="w-full">
                        <mat-label>Descrição</mat-label>
                        <input matInput (blur)="filterMovimentacoes($event)" [(ngModel)]="filterModel.Descricao" />
                    </mat-form-field>
                </div>

                <div class="form-input mt-3">
                    <mat-form-field class="w-full">
                        <mat-label>Tipo Movimentação</mat-label>
                        <mat-select [(ngModel)]="filterModel.Tipo">
                            @for (tipo of TipoMovimentacaoOptions; track tipo) {
                                <mat-option (click)="filterMovimentacoes($event)" [value]="tipo.value">{{tipo.label}}</mat-option>
                            }
                        </mat-select>
                    </mat-form-field>
                </div>
                    
                <div class="form-input">
                    <mat-label class="flex-none">Pendente</mat-label> 
                    <mat-slide-toggle (click)="filterMovimentacoes($event)" [(ngModel)]="filterModel.Pendente" class="p-2 flex-1"></mat-slide-toggle>
                </div>

                <div class="form-input mt-3">
                    <mat-form-field class="w-full">
                        <mat-label>Categoria</mat-label>
                        <mat-select [(ngModel)]="filterModel.CategoriaId">
                            @for (categoria of categorias; track categoria) {
                                <mat-option (click)="filterMovimentacoes($event)" [value]="categoria.id">{{categoria.descricao}}</mat-option>
                            }
                        </mat-select>
                    </mat-form-field>
                </div>

                <mat-form-field class="form-input mt-3">
                    <mat-label>Periodo</mat-label>
                    <mat-date-range-input (blur)="filterMovimentacoes($event)" [rangePicker]="picker">
                      <input matStartDate [(ngModel)]="filterModel.DataInicial" placeholder="Data Inicial">
                      <input matEndDate [(ngModel)]="filterModel.DataFinal" placeholder="Data Final">
                    </mat-date-range-input>
                    <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-date-range-picker #picker></mat-date-range-picker>
                  </mat-form-field>
            </div>
        </mat-card-content>
    </mat-card>

    <div class="action-fields-container">
        <button mat-fab class="button-delete">
            <mat-icon>delete</mat-icon>
        </button>
        
        <button mat-fab class="button-add">
            <mat-icon>add</mat-icon>
        </button>
    </div>

    <mat-card appearance="outlined" class="flex p-5 overflow-x-auto">
        <table mat-table [dataSource]="movimentacoesDataSource" class="">
        
            <ng-container matColumnDef="descricao">
                <th mat-header-cell *matHeaderCellDef>Descrição</th>
                <td mat-cell *matCellDef="let mov"> {{mov.descricao}} </td>
            </ng-container>
    
            <ng-container matColumnDef="observacao">
                <th mat-header-cell *matHeaderCellDef>Observação</th>
                <td mat-cell *matCellDef="let mov"> {{mov.observacao}} </td>
            </ng-container>
    
            <ng-container matColumnDef="valor">
                <th mat-header-cell *matHeaderCellDef>Valor</th>
                <td mat-cell *matCellDef="let mov"> {{mov.valor.toFixed(2)}} </td>
            </ng-container>
    
            <ng-container matColumnDef="data">
                <th mat-header-cell *matHeaderCellDef>Data</th>
                <td mat-cell *matCellDef="let mov"> {{mov.data}} </td>
            </ng-container>
    
            <ng-container matColumnDef="tipo">
                <th mat-header-cell *matHeaderCellDef>Tipo</th>
                <td mat-cell *matCellDef="let mov">
                    <tipo-movimentacao-column-template [tipoMovimentacao]="mov.tipoMovimentacao"/>
                </td>
            </ng-container>
    
            <ng-container matColumnDef="pendente">
                <th mat-header-cell *matHeaderCellDef>Pendente</th>
                <td mat-cell *matCellDef="let mov"> {{mov.pendente}} </td>
            </ng-container>
    
            <ng-container matColumnDef="conta">
                <th mat-header-cell *matHeaderCellDef>Conta</th>
                <td mat-cell *matCellDef="let mov"> {{mov.conta}} </td>
            </ng-container>
    
            <ng-container matColumnDef="categoria">
                <th mat-header-cell *matHeaderCellDef>Categoria</th>
                <td mat-cell *matCellDef="let mov"> {{mov.categoria}} </td>
            </ng-container>
    
            <tr mat-header-row *matHeaderRowDef="colunas"></tr>
            <tr mat-row *matRowDef="let row; columns: colunas;"></tr>
        </table>

        <mat-paginator  class="mt-2" [pageSizeOptions]="[10, 25, 50]"
                        showFirstLastButtons />
    </mat-card>
</main>